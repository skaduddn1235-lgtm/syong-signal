<!doctype html><html lang="ko"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>송숑 레버 신호기 v1.2 · Stooq</title>
<style>
body{margin:0;background:#0b0d12;color:#e7e9ef;font-family:Arial,sans-serif}
section{margin:16px;padding:16px;background:#151924;border-radius:12px}
h2{margin:0 0 12px 0;font-size:20px}
table{width:100%;border-collapse:collapse;font-size:14px}
td,th{padding:6px;border-bottom:1px solid #1e2430;text-align:center}
.red{color:#ff6b6b}
.green{color:#27d17f}
.warn{color:#ffd166}
.btn{padding:10px 14px;border-radius:8px;border:none;background:#1f6feb;color:white;margin-right:6px}
</style></head><body>

<section>
<h2>송숑 레버 신호기 v1.2 · Stooq (일봉)</h2>
<p class="warn">※ Stooq 데이터는 1일 1회 업데이트, 시세는 "종가" 기준.</p>
</section>

<section>
<h2>1. 레버 종목 신호</h2>
<table id="tbl">
<thead><tr>
<th>티커</th><th>현재가</th><th>MA5</th><th>MA20</th><th>MA60</th><th>MA120</th><th>RSI14</th><th>추세</th><th>신호</th></tr></thead>
<tbody></tbody>
</table>
</section>

<script>
const tickers=["TQQQ","SOXL","QLD","NVDL","METU","TSLL"];
const proxy="https://api.allorigins.win/raw?url=";
const url=t=>proxy+encodeURIComponent(`https://stooq.com/q/d/l/?s=${t.toLowerCase()}.us&i=d`);

async function loadCSV(t){
  try{
    const r=await fetch(url(t));
    if(!r.ok) throw new Error("fetch fail");
    const tx=await r.text();
    return parseCSV(tx);
  }catch(e){return null;}
}

function parseCSV(s){
  const L=s.trim().split("\n").slice(1).map(l=>{
    const[x,o,h,lo,c]=l.split(",");
    return {date:x,close:+c};
  });
  return L.filter(v=>!isNaN(v.close));
}

function SMA(arr,n){
  if(arr.length<n) return null;
  let s=0;
  for(let i=arr.length-n;i<arr.length;i++) s+=arr[i].close;
  return (s/n).toFixed(2);
}

function RSI(data,period=14){
  if(data.length<period+1) return null;
  let gains=0,loss=0;
  for(let i=data.length-period;i<data.length;i++){
    const diff=data[i].close-data[i-1].close;
    if(diff>0) gains+=diff; else loss-=diff;
  }
  const rs=gains/(loss||1);
  return (100-(100/(1+rs))).toFixed(1);
}

function trend(ma5,ma20,ma60){
  if(!ma5||!ma20||!ma60) return "-";
  if(ma5>ma20&&ma20>ma60) return "상승";
  if(ma5<ma20&&ma20<ma60) return "하락";
  return "혼조";
}

function signal(tr,rsi){
  if(!tr||!rsi) return "-";
  if(rsi>70) return "과열 · 매도주의";
  if(rsi<30) return "과매도 · 소액 DCA";
  if(tr==="상승") return "추세매수";
  if(tr==="하락") return "관망/현금";
  return "유지";
}

async function run(){
  const tb=document.querySelector("#tbl tbody");
  tb.innerHTML="";
  for(const t of tickers){
    const d=await loadCSV(t);
    if(!d){
      tb.innerHTML+=`<tr><td>${t}</td><td colspan="8" class="red">데이터 실패</td></tr>`;
      continue;
    }
    const c=d[d.length-1].close.toFixed(2);
    const ma5=SMA(d,5), ma20=SMA(d,20), ma60=SMA(d,60), ma120=SMA(d,120);
    const r=RSI(d,14);
    const tr=trend(ma5,ma20,ma60);
    const sg=signal(tr,r);

    tb.innerHTML+=`
    <tr>
      <td>${t}</td>
      <td>${c}</td>
      <td>${ma5??"-"}</td>
      <td>${ma20??"-"}</td>
      <td>${ma60??"-"}</td>
      <td>${ma120??"-"}</td>
      <td>${r??"-"}</td>
      <td>${tr}</td>
      <td>${sg}</td>
    </tr>`;
  }
}
run();
</script>

</body></html>
